# 固定dom的位置 使用js调试dom的相关工具库 
## stick是粘附 无法超出 只能通过  transform: translateX(50px); /* 减少向左的偏移（抵消更少） */
进行扩展偏移


# 动画进度时间轴
这段代码实现平滑滚动动画的核心原理是利用 **GSAP时间线（Timeline）** 与 **ScrollTrigger插件** 的协同，将多个动画属性（位置、透明度、缩放）按时间顺序或并行关系精确控制，同时通过滚动进度驱动整个动画流程，从而避免了"瞬移"问题。


### 核心原理拆解：


#### 1. **ScrollTrigger：滚动驱动动画的"引擎"**
ScrollTrigger的作用是将动画进度与页面滚动进度绑定，实现"滚动多少，动画执行多少"的效果。  
关键参数解析：
- `trigger: ".stage-container"`：以`.stage-container`元素作为滚动监测的参考对象
- `start: "top top"`：当`.stage-container`的顶部与视口顶部对齐时，动画开始
- `end: "bottom bottom"`：当`.stage-container`的底部与视口底部对齐时，动画结束
- `scrub: true`：核心！让动画进度完全跟随滚动进度（滚动停止，动画暂停；滚动反向，动画回退）


#### 2. **GSAP时间线（Timeline）：动画的"调度中心"**
`gsap.timeline()` 用于将多个动画步骤按时间顺序或并行关系组织，确保所有属性（位置、透明度、缩放）的变化同步、有序，避免单个属性独立变化导致的"瞬移"。  
时间线的时间单位是 **相对进度（0~1）**，对应整个滚动范围（从`start`到`end`的滚动距离）：
- `0` 表示滚动开始时
- `1` 表示滚动结束时
- 中间值（如0.2、0.8）表示滚动到对应比例的位置


#### 3. **分阶段控制动画属性：平滑过渡的关键**
代码将人像层的动画拆分为 **3组独立但同步的属性变化**（Y轴移动、透明度、缩放），每组属性按"分段过渡"的逻辑设计，避免突变：


##### （1）Y轴移动动画：全程线性变化
```js
tl.to(curtainRef.value, {
  y: -250, // 从初始y=0移动到y=-250
  ease: "none", // 线性移动，无加速减速
}, 0) // 从滚动开始（0时刻）就执行，全程持续
```
- 原理：随着滚动进度从0到1，人像层沿Y轴匀速向上移动250px，与背景层形成视差效果。


##### （2）透明度动画：分三段过渡（渐入→保持→渐出）
```js
// 0~0.2阶段：透明度从0渐变为1（渐入）
tl.to(curtainRef.value, { opacity: 1, duration: 0.2 }, 0)
// 0.2~0.8阶段：保持透明度为1（中间清晰显示）
.to(curtainRef.value, { opacity: 1, duration: 0.6 }, 0.2)
// 0.8~1阶段：透明度从1渐变为0（渐出）
.to(curtainRef.value, { opacity: 0, duration: 0.2 }, 0.8)
```
- 时间逻辑：总滚动范围中，前20%的距离用于渐入，中间60%保持清晰，最后20%用于渐出。
- 避免瞬移：通过明确的时间分段，让透明度变化有"缓冲带"，而非突然切换。


##### （3）缩放动画：分四段过渡（初始→放大→保持→缩小）
```js
// 0~0.3阶段：保持原始大小（1倍）
tl.to(curtainRef.value, { scale: 1, duration: 0.3 }, 0)
// 0.3~0.5阶段：从1倍放大到1.1倍（中间突出）
.to(curtainRef.value, { scale: 1.1, duration: 0.2, ease: "sine.inOut" }, 0.3)
// 0.5~0.7阶段：保持1.1倍（突出显示）
// 0.7~0.9阶段：从1.1倍缩小回1倍
.to(curtainRef.value, { scale: 1, duration: 0.2, ease: "sine.inOut" }, 0.7)
// 0.9~1阶段：保持1倍
.to(curtainRef.value, { scale: 1, duration: 0.3 }, 0.9)
```
- 原理：通过`sine.inOut`缓动函数，让缩放变化在开始和结束时更平缓（类似"先慢后快再慢"），避免突然变大/变小。
- 中间突出：在滚动到30%~70%的阶段（核心视觉区），人像略微放大，增强存在感。


#### 4. **初始化状态统一：避免"起点不一致"导致的瞬移**
```js
gsap.set(curtainRef.value, {
  y: 0,
  opacity: 0,
  transform: "translate(-50%, -100%) scale(1)"
})
```
- 作用：在动画开始前，强制设置人像层的初始状态（位置、透明度、缩放），与动画的"0时刻"状态完全一致。
- 为什么重要？如果初始状态（如默认opacity为1）与动画起始状态（opacity为0）不一致，滚动开始时会突然跳变（瞬移）。


### 总结：为什么能实现平滑动画？
1. **滚动驱动**：通过ScrollTrigger将动画进度与滚动进度绑定，实现"所见即所得"的实时反馈。
2. **时间线调度**：用Timeline统一管理多个属性动画，确保位置、透明度、缩放同步变化，避免属性"各自为政"。
3. **分段过渡**：将每个属性的变化拆分为多个阶段（如渐入→保持→渐出），并加入缓动函数，消除突变。
4. **初始状态对齐**：通过`gsap.set()`确保动画起点与元素初始状态一致，避免滚动开始时的跳变。

这些机制共同作用，最终实现了"随滚动自然过渡"的视差动画效果。
